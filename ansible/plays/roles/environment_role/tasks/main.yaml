---
- name: Installing Packages
  ansible.builtin.apt:
    pkg:
      - qemu-guest-agent
    state: present
    update-cache: true

- name: Setting Hostname
  ansible.builtin.hostname:
    name: "{{ inventory_hostname }}"

- name: Set SSH Authorized Keys
  ansible.posix.authorized_key:
    user: '{{ ansible_user }}'
    state: present
    key: '{{ item }}'
  with_file: '{{ ssh_authorized_keys }}'

- name: Create SSH Private Key
  ansible.builtin.copy:
    dest: /home/github/.ssh/id_ed25519
    content: "{{ ssh_private_key }}"
    mode: "0600"
  when: create_ssh_private_key
