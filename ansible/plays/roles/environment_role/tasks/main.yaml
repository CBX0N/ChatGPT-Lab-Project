---
- name: Installing Packages
  ansible.builtin.apt:
    pkg:
      - qemu-guest-agent
    state: present
    update-cache: true

- name: Setting Hostname
  ansible.builtin.hostname:
    name: "{{ inventory_hostname }}"

# - name: Set SSH Authorized Keys
#   ansible.posix.authorized_key:
#     state: present
#     user: '{{ ansible_user }}'
#     key: '{{ item }}'
#   with_File:
#     - '{{ ssh_authorized_keys }}'

- name: Set up multiple authorized keys
  ansible.posix.authorized_key:
    user: ansible
    state: present
    key: '{{ item }}'
  with_file:
    - files/public_keys/cbxon.pub
    - files/public_keys/github.pub

- name: Create SSH Private Key
  ansible.builtin.copy:
    dest: ~/.ssh/id_ed25519
    content: "{{ ssh_private_key }}"
    mode: "0600"
  when: create_ssh_private_key
